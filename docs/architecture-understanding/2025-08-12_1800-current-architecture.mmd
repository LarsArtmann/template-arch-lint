graph TB
    subgraph "üåê Presentation Layer"
        API[Gin HTTP Server<br/>handlers, middleware]
        TEMPL[a-h/templ Templates<br/>type-safe HTML]
        STATIC[Static Assets<br/>CSS, JS, images]
    end

    subgraph "üèóÔ∏è Application Layer"
        HANDLERS[HTTP Handlers<br/>user_handler.go]
        MIDDLEWARE[Middleware Stack<br/>logging, auth, CORS]
        SERVICES[Application Services<br/>orchestration logic]
    end

    subgraph "üèõÔ∏è Domain Layer"
        ENTITIES[Domain Entities<br/>User, ValueObjects]
        REPOS[Repository Interfaces<br/>UserRepository]
        DOMAIN_SERVICES[Domain Services<br/>business rules]
        EVENTS[Domain Events<br/>event publishing]
        VALUES[Value Objects<br/>UserID, Email, Username]
    end

    subgraph "üîß Infrastructure Layer"
        SQL_REPO[SQL Repository<br/>sqlc generated]
        MEMORY_REPO[In-Memory Repository<br/>testing]
        DB[SQLite Database<br/>type-safe queries]
        CACHE[Caching Layer<br/>performance]
        EXTERNAL[External Services<br/>APIs, messaging]
    end

    subgraph "üìä Observability Stack"
        OTEL[OpenTelemetry<br/>tracing, metrics]
        PROM[Prometheus<br/>metrics collection]
        GRAFANA[Grafana<br/>dashboards, alerts]
        LOGS[Structured Logging<br/>JSON logs]
    end

    subgraph "‚öôÔ∏è Configuration Management"
        CONFIG[Viper Configuration<br/>hot reloading]
        SECRETS[Secrets Manager<br/>secure credentials]
        DRIFT[Drift Detection<br/>config monitoring]
        FEATURES[Feature Flags<br/>runtime toggles]
    end

    subgraph "üöÄ Deployment Infrastructure"
        DOCKER[Docker Containers<br/>multi-stage builds]
        K8S[Kubernetes<br/>HPA, ingress, RBAC]
        MONITORING[Monitoring Stack<br/>Prometheus, Grafana]
        SECURITY[Security Scanning<br/>govulncheck, container security]
    end

    subgraph "üß™ Testing Infrastructure"
        UNIT[Unit Tests<br/>Ginkgo BDD]
        INTEGRATION[Integration Tests<br/>end-to-end]
        BENCHMARK[Performance Tests<br/>benchmarking]
        COVERAGE[Test Coverage<br/>reporting]
    end

    subgraph "üîí Security Layer"
        AUTH[Authentication<br/>JWT, sessions]
        AUTHZ[Authorization<br/>RBAC, permissions]
        VULNSCAN[Vulnerability Scanning<br/>continuous monitoring]
        HEADERS[Security Headers<br/>OWASP best practices]
    end

    %% Flow connections
    API --> HANDLERS
    HANDLERS --> SERVICES
    SERVICES --> REPOS
    REPOS --> SQL_REPO
    REPOS --> MEMORY_REPO
    SQL_REPO --> DB
    
    HANDLERS --> MIDDLEWARE
    MIDDLEWARE --> AUTH
    MIDDLEWARE --> AUTHZ
    
    SERVICES --> DOMAIN_SERVICES
    DOMAIN_SERVICES --> ENTITIES
    ENTITIES --> VALUES
    ENTITIES --> EVENTS
    
    API --> TEMPL
    TEMPL --> STATIC
    
    %% Observability connections
    HANDLERS -.-> OTEL
    SERVICES -.-> OTEL  
    SQL_REPO -.-> OTEL
    OTEL --> PROM
    PROM --> GRAFANA
    HANDLERS -.-> LOGS
    
    %% Configuration connections
    HANDLERS --> CONFIG
    SERVICES --> CONFIG
    CONFIG --> SECRETS
    CONFIG --> DRIFT
    CONFIG --> FEATURES
    
    %% Infrastructure connections
    API -.-> DOCKER
    DOCKER -.-> K8S
    K8S -.-> MONITORING
    K8S -.-> SECURITY
    
    %% Testing connections
    HANDLERS -.-> UNIT
    SERVICES -.-> UNIT
    ENTITIES -.-> UNIT
    API -.-> INTEGRATION
    SERVICES -.-> BENCHMARK
    
    %% Security connections
    API --> HEADERS
    MIDDLEWARE --> VULNSCAN
    
    %% Styling
    classDef presentation fill:#e1f5fe
    classDef application fill:#f3e5f5  
    classDef domain fill:#e8f5e8
    classDef infrastructure fill:#fff3e0
    classDef observability fill:#fce4ec
    classDef config fill:#f1f8e9
    classDef deployment fill:#e0f2f1
    classDef testing fill:#fff8e1
    classDef security fill:#ffebee
    
    class API,TEMPL,STATIC presentation
    class HANDLERS,MIDDLEWARE,SERVICES application
    class ENTITIES,REPOS,DOMAIN_SERVICES,EVENTS,VALUES domain
    class SQL_REPO,MEMORY_REPO,DB,CACHE,EXTERNAL infrastructure
    class OTEL,PROM,GRAFANA,LOGS observability
    class CONFIG,SECRETS,DRIFT,FEATURES config
    class DOCKER,K8S,MONITORING,SECURITY deployment
    class UNIT,INTEGRATION,BENCHMARK,COVERAGE testing
    class AUTH,AUTHZ,VULNSCAN,HEADERS security